name: Feature Branch CI

on:
  push:
    branches:
      - '*'
      - '!master'
      - '!release*'

permissions:
  contents: read
  actions: read
  checks: write

jobs:
  test:
    name: Run unit Tests
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v1
    - name: set up JDK 17
      uses: actions/setup-java@v1
      with:
        java-version: 17
    - name: Unit test
      env:
        openweathermapApiKey: ${{ secrets.OPENWEATHERMAPAPIKEY }}
      run: bash ./gradlew testDebugUnitTest --stacktrace

  report:
    runs-on: ubuntu-latest
    steps:
      - uses: dorny/test-reporter@v2
        with:
          artifact: test-results            # artifact name
          name: Jest Tests                  # Name of the check run which will be created
          path: '*.xml'                     # Path to test results (inside artifact .zip)
          reporter: jest-junit
